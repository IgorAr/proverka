<!DOCTYPE HTML>
<html>

<head>
    <script src="students.js">
    </script>
    <script src="jquery-2.1.4.js" type="text/javascript">
    </script>
    <meta charset="utf-8">
    <link rel="stylesheet" href="tableStyle.css">
    <style type="text/css">
    </style>
</head>

<body>

    <script>
        var colors = [
	  '#FF0000',
	 '#FF3300',
	  '#FF6600',
       '#FF8000',
       '#FFB200',
	   '#FFCC00',
	   '#FFE500',
	   '#FFFF00',
	   '#CCFF00',
	   '#99FF00',
	   '#33FF00',
	   '#00CC00'
        ]
        function disciplines(dataFile) {
            var models = new Array();
            for (var i = 0; i < dataFile.length; i++) {
                var student = dataFile[i];
                if (typeof models[student.Name] === 'undefined') {
                    models[student.Name] = 0;
                }
                if (student.Passed == true) {
                    models[student.Name]++;
                }
            }
            return models;
        }

        function comparison(a, b) {
            a = a[1];
            b = b[1];
            return a < b ? -1 : (a > b ? 1 : 0);
        };

        function sortDisciplines(disciplines) {
            var temp = [];
            for (var key in disciplines) temp.push([key, disciplines[key]]);
            temp.sort(comparison);
            return temp;
        }

        function color(students, n) {
            var p = Math.floor((colors.length / students.length) * n);
            var color = colors[p]
            return color;
        }

        function table(sortDisciplines) {
            var tab = document.createElement("table");
            var disRow = document.createElement('tr');
            var disCell1 = document.createElement('th');
            var disText1 = document.createTextNode('Student name');
            var disCell2 = document.createElement('th');
            var disText2 = document.createTextNode('Прямоугольник');
            disCell1.appendChild(disText1);
            disRow.appendChild(disCell1);
            disCell2.appendChild(disText2);
            disRow.appendChild(disCell2);
            tab.appendChild(disRow);
            for (var i = 0; i < sortDisciplines.length; i++) {
                var studentRow = document.createElement('tr');
                var studentCell = document.createElement('th');
                var studentText = document.createTextNode(sortDisciplines[i][0]);
                studentCell.appendChild(studentText);
                studentRow.appendChild(studentCell);
                var boxCell = document.createElement('td');
                var box = document.createElement('div');
                box.style.width = 50 + sortDisciplines[i][1] + '%';
                box.style.height = '50px';
                box.style.background = color(sortDisciplines, sortDisciplines[i][1]);
                boxCell.appendChild(box);
                studentRow.appendChild(boxCell);
                tab.appendChild(studentRow);
            }
            document.body.appendChild(tab);
        }
        $(document).ready(function () {
            var p1 = disciplines(data);
            var p2 = sortDisciplines(p1);
            table(p2);
        });
    </script>
    <a href="students.html">Студенты</a>
    <a href="disciplines.html">Дисциплины</a>

</body>

</html>
